/*----------------------------------------------------------------------------\
|          Copyright(c) 2024 Jerry Pylarinos.                                 |
|          This program is protected by copyright and information             |
|          contained therein is confidential. The program may not be          |
|          copied and the information may not be used or disclosed            |
|          except with the written permission of the proprietor(s).           |
|                                                                             |
|-----------------------------------------------------------------------------|
|                                                                             |
|   Module Name  : fw_test.c Module File.                                     |
|                                                                             |
|   Author       : Jerry Pylarinos                                            |
|                                                                             |
|   Date         : 24 …·Ì 2024                                                |
|                                                                             |
|-----------------------------------------------------------------------------|
|                                                                             |
|   <Module Description>                                                      |
|                                                                             |
\----------------------------------------------------------------------------*/

/*----------------------------------------------------------------------------\
|   Compiler Controls                                                         |
\----------------------------------------------------------------------------*/

/*----------------------------------------------------------------------------\
|   Header Files                                                              |
\----------------------------------------------------------------------------*/

#include <stddef.h>
#include <stdio.h>
#include <stdbool.h>
#include <string.h>

#include "HL_sci.h"

#include "fw_globals.h"
#include "fw_uart.h"

#include "fw_test.h"

/*----------------------------------------------------------------------------\
|   Public Constant Definitions                                               |
\----------------------------------------------------------------------------*/

/*----------------------------------------------------------------------------\
|   Public Data Definitions                                                   |
\----------------------------------------------------------------------------*/

/*----------------------------------------------------------------------------\
|   Private Type Definitions                                                  |
\----------------------------------------------------------------------------*/

/*----------------------------------------------------------------------------\
|   Private Constant Definitions                                              |
\----------------------------------------------------------------------------*/

/*----------------------------------------------------------------------------\
|   Private Data Declarations                                                 |
\----------------------------------------------------------------------------*/

/*----------------------------------------------------------------------------\
|   Private Function Declarations                                             |
\----------------------------------------------------------------------------*/

static void test_uart( void );

/*----------------------------------------------------------------------------\
|   Public Function Implementations                                           |
\----------------------------------------------------------------------------*/

void fw_test( void )
{
    test_uart();
}

/*----------------------------------------------------------------------------\
|   Private Function Implementations                                          |
\----------------------------------------------------------------------------*/

static void test_uart( void )
{
    static S_UART_INFO tx_info;

    // printf( "F/W Test: UART\n" );
    tx_info.id = eUART_0;           /* SCI1 */
    tx_info.sci = UART( eUART_0 );

    tx_info.payload[0] = 0x02;  // STX
    tx_info.payload[1] = '1';   // Device Address
    tx_info.payload[2] = '1';   //
    tx_info.payload[3] = '0';   // Sub Address
    tx_info.payload[4] = '0';   //
    tx_info.payload[5] = 'C';   // Type
    tx_info.payload[6] = '2';   // Packet ID
    tx_info.payload[7] = '3';   //
    tx_info.payload[8] = '0';   // Length
    tx_info.payload[9] = '0';   //
    tx_info.payload[10] = '1';  // Command / Query ( f_CMDCommCenterFreq = '1', '0' )
    tx_info.payload[11] = '0';  //
    tx_info.payload[12] = '4';  // CRC: 0x40BA7EA2
    tx_info.payload[13] = '0';  //
    tx_info.payload[14] = 'B';  //
    tx_info.payload[15] = 'A';  //
    tx_info.payload[16] = '7';  //
    tx_info.payload[17] = 'E';  //
    tx_info.payload[18] = 'A';  //
    tx_info.payload[19] = '2';  //
    tx_info.payload[20] = 0x03; // ETX
    tx_info.payload[21] = '\0'; // NULL terminated

    sciSend( tx_info.sci, sizeof( tx_info ), ( uint8 * ) &tx_info );
}

/*----------------------------------------------------------------------------\
|   End of fw_test.c module                                                   |
\----------------------------------------------------------------------------*/
